(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ae47370"],{"00ba":function(t,e,s){},"0617":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page"},[s("div",{staticClass:"page-header"},[s("h2",{staticClass:"page-header__title"},[t._v(t._s(t.pageTitle))]),s("div",{staticClass:"page-header__actions"},[s("RisksAddEditModal",[s("button",{staticClass:"btn btn-dark"},[t._v("New Risk")])])],1)]),s("div",{staticClass:"card-body white-card-body card-body_full-height"},[s("RisksTable")],1)])},n=[],r=s("f774"),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"h-100"},[i("div",{staticClass:"row m-b-20"},[i("div",{staticClass:"col-lg-4 col-12"},[i("div",{staticClass:"position-relative"},[i("b-icon",{staticClass:"icon-searh",attrs:{icon:"search"}}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"form-control form-control_search",attrs:{type:"text",placeholder:"Search"},domProps:{value:t.searchInput},on:{keyup:t.searching,input:function(e){e.target.composing||(t.searchInput=e.target.value)}}}),t.isActive?i("button",{staticClass:"btn-clear",on:{click:t.clearInput}},[i("b-icon",{staticClass:"icon-clear",attrs:{icon:"x-circle"}})],1):t._e()],1)]),0!==t.filteredRisksComputed.length&&t.searchInput?i("div",{staticClass:"col-4"},[i("p",[t._v("Found "+t._s(t.filteredRisksComputed.length)+" "+t._s(1===t.filteredRisksComputed.length?"result":"results"))])]):t._e()]),i("div",{staticClass:"row"},[i("div",{staticClass:"col-12"},[i("Loading"),i("table",{staticClass:"table"},[i("thead",[i("tr",[i("th",{staticStyle:{width:"100%"}},[t._v("Name"),i("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),i("th",[t._v("Impact"),i("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),i("th",[t._v("Likelihood"),i("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),i("th",[t._v("Risk Level"),i("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),i("th",{staticClass:"text-right",staticStyle:{width:"1%"}},[t._v("Date Created"),i("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),i("th",{staticClass:"text-right",attrs:{width:"35px"}})])]),!t.loading&&t.filteredRisksComputed&&t.filteredRisksComputed.length?i("tbody",[t._l(t.filteredRisksComputed,(function(e){return[i("tr",{key:e.id},[i("td",[i("div",{staticClass:"d-flex align-items-center link truncate"},[0!==e.compliance_policies.length?i("div",{staticClass:"dropdown-toggle",attrs:{id:"#sectionIcon-"+e.id},on:{click:function(s){return t.toogleSections(e.id)}}},[i("b-icon",{staticClass:"m-r-1 sm-icon",attrs:{icon:"chevron-right"}})],1):t._e(),i("a",{staticClass:"custom-text",attrs:{href:"/business/risks/"+e.id}},[t._v(t._s(e.name))])]),e.compliance_policies?i("div",{staticClass:"dropdown-items mb-2",attrs:{id:"#section-"+e.id}},[i("ul",{staticClass:"list-unstyled ml-3"},t._l(e.compliance_policies,(function(e){return i("li",{key:e.id,staticClass:"mb-2"},[i("a",{staticClass:"link custom-text",attrs:{href:"/business/compliance_policies/"+e.id}},[i("img",{staticClass:"icon-policy",attrs:{src:s("6346")}}),t._v(t._s(e.name))])])})),0)]):t._e()]),i("td",[t._v(t._s(t.showLevel(e.impact)))]),i("td",[t._v(t._s(t.showLevel(e.likelihood)))]),i("td",[i("b-badge",{staticClass:"mr-2 badge-risk",attrs:{variant:t.badgeVariant(e.risk_level)}},[i("b-icon-exclamation-triangle-fill",{staticClass:"mr-2"}),t._v(t._s(t.showLevel(e.risk_level)))],1)],1),i("td",{staticClass:"text-right"},[t._v(t._s(t.dateToHuman(e.created_at)))]),i("td",{staticClass:"text-right"},[i("div",{staticClass:"actions"},[i("b-dropdown",{staticClass:"m-0 p-0",attrs:{size:"xs",variant:"none",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("b-icon",{staticClass:"three-dots",attrs:{icon:"three-dots"}})]},proxy:!0}],null,!0)},[i("RisksAddEditModal",{attrs:{risks:t.risksComputed,riskId:e.id,inline:!1}},[i("b-dropdown-item-button",[t._v("Edit")])],1),i("b-dropdown-item-button",{staticClass:"delete",on:{click:function(s){return t.deleteRisk(e.id)}}},[t._v("Delete")])],1)],1)])]),e.compliance_policies?t._l(e.compliance_policies,(function(n){return i("tr",{key:"risk-"+e.id+"-"+n.id,staticClass:"d-none",class:"risk-"+e.id},[i("td",[i("a",{staticClass:"link custom-text policy-in-risk",attrs:{href:"/business/compliance_policies/"+n.id}},[i("img",{staticClass:"icon-policy",attrs:{src:s("6346")}}),t._v(t._s(n.name))])]),i("td"),i("td"),i("td"),i("td"),i("td",{staticClass:"text-right"},[i("div",{staticClass:"actions"},[i("b-dropdown",{staticClass:"m-0 p-0",attrs:{size:"xs",variant:"none",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("b-icon",{staticClass:"three-dots",attrs:{icon:"three-dots"}})]},proxy:!0}],null,!0)},[i("b-dropdown-item-button",{staticClass:"delete",on:{click:function(s){return t.deletePolicy(e,n.id)}}},[t._v("Unlink")])],1)],1)])])})):t._e()]}))],2):t._e()])],1)]),t.filteredRisksComputed.length||t.loading?t._e():i("div",{staticClass:"row"},[i("div",{staticClass:"col h-100 text-center"},[i("EmptyState")],1)])])},o=[],c=s("9523"),l=s.n(c),d=s("e829"),u=s("4724"),p=s("1315");function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function m(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){l()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var k={mixins:[Object(r["a"])()],props:{},components:{Loading:d["a"],RisksAddEditModal:u["a"]},data:function(){return{levelOptions:["Low","Medium","High"],open:!0,searchInput:"",isActive:!1}},methods:{deletePolicy:function(t,e){var s=this,i=t.compliance_policies.findIndex((function(t){return t.id===e}));t.compliance_policies.splice(i,1),t.compliance_policy_ids=t.compliance_policies.map((function(t){return t.id})),this.$store.dispatch("updateRisk",m({},t)).then((function(t){console.log("response",t),s.toast("Success","Risk has been updated.")}))["catch"]((function(t){console.error(t),s.toast("Error","Risk has not been updated. Please try again. ".concat(t))}))},getRisks:function(t){return console.log("risks",t),t},badgeVariant:function(t){return 0===t?"success":1===t?"warning":2===t?"danger":void 0},showLevel:function(t){return this.levelOptions[t]},dateToHuman:function(t){var e=p["DateTime"].fromJSDate(new Date(t));return e.invalid?e.invalid?t:void 0:e.toFormat("MM/dd/yyyy")},deleteRisk:function(t){var e=this;this.$store.dispatch("deleteRisk",{id:t}).then((function(t){e.toast("Success","Risk successfully deleted!")}))["catch"]((function(t){e.toast("Error","Couldn't delete risk! ".concat(t))}))},searching:function(){this.searchInput.length&&(this.isActive=!0),this.$emit("searching",this.searchInput)},clearInput:function(){this.searchInput="",this.isActive=!1,this.$emit("searching",this.searchInput)},toogleSections:function(t){for(var e=document.getElementsByClassName("risk-".concat(t)),s=0;s<e.length;s++)e[s].classList.toggle("d-none");document.getElementById("#sectionIcon-".concat(t)).classList.toggle("active")}},computed:{loading:function(){return this.$store.getters.loading},risksComputed:function(){return this.$store.getters.risksList},filteredRisksComputed:function(){var t=this;return this.risksComputed.filter((function(e){var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes(t.searchInput.toLowerCase())}))}},mounted:function(){this.$store.dispatch("getRisks").then((function(t){console.log("response",t)}))["catch"]((function(t){console.error(t)}))}},f=k,v=(s("826f"),s("2877")),b=Object(v["a"])(f,a,o,!1,null,"0092e31e",null),g=b.exports,C={mixins:[Object(r["a"])()],components:{RisksTable:g,RisksAddEditModal:u["a"]},data:function(){return{pageTitle:"Risk Register"}},methods:{},computed:{loading:function(){return this.$store.getters.loading}},mounted:function(){}},_=C,y=(s("bf2b"),Object(v["a"])(_,i,n,!1,null,null,null));e["default"]=y.exports},4724:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{"d-inline-block":t.inline}},[s("div",{directives:[{name:"b-modal",rawName:"v-b-modal",value:t.modalId,expression:"modalId"}],class:{"d-inline-block":t.inline}},[t._t("default")],2),s("b-modal",{staticClass:"fade",attrs:{id:t.modalId,title:t.riskId?"Edit risk":"New risk"},on:{close:t.hideModal,show:t.newEtag}},[s("ModelLoader",{attrs:{url:t.riskId?t.submitUrl:void 0,default:t.initialrisk,etag:t.etag},on:{loaded:t.loadrisk}},[t.showRiskOption?s("b-form-group",{staticClass:"form-label mb-3",attrs:{id:"input-group-1",label:"Risk","label-for":"select-1"}},[s("b-form-select",{attrs:{id:"select-1",options:t.options,required:""},on:{change:t.onChange},model:{value:t.risk.risks,callback:function(e){t.$set(t.risk,"risks",e)},expression:"risk.risks"}}),s("Errors",{attrs:{errors:t.errors.risk}})],1):t._e(),s("b-row",{attrs:{"no-gutters":""}},[s("div",{staticClass:"col"},[s("label",{staticClass:"form-label"},[t._v("Risk Name")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.risk.name,expression:"risk.name"}],staticClass:"form-control",domProps:{value:t.risk.name},on:{input:function(e){e.target.composing||t.$set(t.risk,"name",e.target.value)}}}),s("Errors",{attrs:{errors:t.errors.name}})],1)]),s("b-row",{staticClass:"m-t-1",attrs:{"no-gutters":""}},[s("div",{staticClass:"col-sm m-r-1"},[s("b-form-group",{staticClass:"form-label",attrs:{id:"input-group-2",label:"Impact","label-for":"select-2"}},[s("b-form-select",{attrs:{id:"select-2",errors:t.errors.impact,options:t.levelOptions},on:{change:t.onRiskChange},model:{value:t.risk.impact,callback:function(e){t.$set(t.risk,"impact",e)},expression:"risk.impact"}}),s("Errors",{attrs:{errors:t.errors.impact}})],1)],1),s("div",{staticClass:"col-sm"},[s("b-form-group",{staticClass:"form-label",attrs:{id:"input-group-3",label:"Likelihood","label-for":"select-3"}},[s("b-form-select",{attrs:{id:"select-3",errors:t.errors.likelihood,options:t.levelOptions},on:{change:t.onRiskChange},model:{value:t.risk.likelihood,callback:function(e){t.$set(t.risk,"likelihood",e)},expression:"risk.likelihood"}}),s("Errors",{attrs:{errors:t.errors.likelihood}})],1)],1)]),s("b-row",{staticClass:"mt-2",attrs:{"no-gutters":""}},[s("div",{staticClass:"col"},[s("label",{staticClass:"form-label"},[t._v("Risk Level")]),s("div",[s("b-icon",{staticClass:"mr-3",attrs:{icon:"exclamation-triangle-fill",scale:"1",variant:t.badgeVariant}}),t._v(t._s(t.riskLevelName))],1)])])],1),s("template",{slot:"modal-footer"},[s("button",{staticClass:"btn btn-link",on:{click:function(e){return t.hideModal()}}},[t._v("Cancel")]),s("button",{staticClass:"btn btn-dark",on:{click:t.submit}},[t._v(t._s(t.riskId?"Save":"Add"))])])],2)],1)},n=[],r=s("9523"),a=s.n(r),o=s("f774");function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function l(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){a()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var d=function(){return Math.random().toFixed(10).toString().replace(".","")},u=function(){return{name:"",id:null,impact:0,likelihood:0,compliance_policies:[],compliance_policy_ids:[]}},p={mixins:[Object(o["a"])()],props:{id:String,risks:Array,riskId:Number,remindAt:String,inline:{type:Boolean,default:!0},risksList:Array,policyId:Number,showRiskOption:{type:Boolean,default:!1}},data:function(){return{modalId:this.id||"modal_".concat(d()),risk:u(),isActive:!1,options:[{value:null,text:"New Risk"}],levelOptions:[{value:0,text:"Low"},{value:1,text:"Medium"},{value:2,text:"High"}],badgeVariant:"secondary",riskLevelName:"---",errors:{}}},methods:{hideModal:function(){this.errors={},this.$bvModal.hide(this.modalId)},loadrisk:function(t){this.risk=Object.assign({},this.risk,t),this.onRiskChange(),this.options=[{value:null,text:"New Risk"}],this.options=this.options.concat(this.risksComputedAsOptions)},submit:function(t){var e,s=this;(t.preventDefault(),this.errors={},this.risk.name)?(this.risk.compliance_policy_ids=this.risk.compliance_policies.map((function(t){return t.id})),this.risk.compliance_policy_ids.includes(this.policyId)||this.risk.compliance_policy_ids.push(this.policyId),e=this.riskId||this.risk.id?"updateRisk":"createRisk",this.$store.dispatch(e,l({},this.risk)).then((function(t){if(t.errors){var i="createRisk"===e?"Risk has not been created. Please try again.":"Risk has not been updated. Please try again.";s.toast("Error",i)}else"createRisk"==e?s.toast("Success","Risk has been created."):s.toast("Success","Risk has been updated."),s.$emit("saved",t),s.$bvModal.hide(s.modalId),s.newEtag()}))["catch"]((function(t){console.error(t),s.toast("Error","Risk has not been created. Please try again. ".concat(t),!0)}))):this.$set(this.errors,"name",["Required field"])},onChange:function(t){if(null===t)return this.isActive=!0,this.risk=u(),this.badgeVariant="secondary",void(this.riskLevelName="---");this.isActive=!1;var e=this.risks.find((function(e){return e.id===t}));this.risk=e,this.onRiskChange()},onRiskChange:function(){var t=this.riskLevel(this.risk.likelihood,this.risk.impact);this.riskLevelColor(t),this.getRiskLevelName(t)},getRiskLevelName:function(t){this.riskLevelName=this.levelOptions[t].text},riskLevel:function(t,e){return t>0&&2===e?2:t<2&&0===e?0:1},riskLevelColor:function(t){0===t&&(this.badgeVariant="success"),1===t&&(this.badgeVariant="warning"),2===t&&(this.badgeVariant="danger")}},computed:{initialrisk:function(){return u},canBeDraft:function(){return!this.riskId||"draft"===this.risk.status},submitUrl:function(){var t=this.riskId?"/".concat(this.riskId):"";return"/api/business/risks"+t},httpMethod:function(){return this.riskId?"PUT":"POST"},risksComputedAsOptions:function(){return this.risks.map((function(t){return{value:t.id,text:t.name}}))}},watch:{}},h=p,m=s("2877"),k=Object(m["a"])(h,i,n,!1,null,null,null);e["a"]=k.exports},6346:function(t,e,s){t.exports=s.p+"img/policy.4cd572ac.svg"},"826f":function(t,e,s){"use strict";s("00ba")},bf2b:function(t,e,s){"use strict";s("cda9")},cda9:function(t,e,s){},f774:function(t,e,s){"use strict";var i=s("9523"),n=s.n(i),r=function(){return Math.random()},a=function(t){var e=t||"etag",s="new"+e[0].toUpperCase()+e.substring(1);return{data:function(){return n()({},e,r())},methods:n()({},s,(function(){this[e]=r()}))}};e["a"]=a}}]);
//# sourceMappingURL=chunk-0ae47370.ebd526a3.js.map
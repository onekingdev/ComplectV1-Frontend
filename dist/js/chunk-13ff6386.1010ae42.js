(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13ff6386"],{"0ce7":function(e,t,r){"use strict";r("5485")},5485:function(e,t,r){},"97af":function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("table",{staticClass:"table reviews-table"},[r("thead",[r("tr",[e.check?r("th",{attrs:{width:"5%"}}):e._e(),r("th",{attrs:{width:"45%"}},[e._v("Name")]),r("th",{staticClass:"text-right",attrs:{width:"20%"},on:{click:function(t){return e.sortSelect("progress","number")}}},[e._v("Owner"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{staticClass:"text-right",on:{click:function(t){return e.sortSelect("findings","number")}}},[e._v("Size"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{staticClass:"text-right",on:{click:function(t){return e.sortSelect("updated_at","date")}}},[e._v("Last Modified"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th")])]),r("tbody",[e._l(e.filefolders.folders,(function(t){return e.filefolders.folders?r("FilefoldersItem",{key:"folder-"+t.id,attrs:{item:t,itemType:"folder",check:e.check},on:{selectedItem:e.selectedItemUp}}):e._e()})),e._l(e.filefolders.files,(function(t){return e.filefolders.files?r("FilefoldersItem",{key:"file-"+t.id,attrs:{item:t,itemType:"file",check:e.check},on:{selectedItem:e.selectedItemUp}}):e._e()}))],2)])},n=[],o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[e.check?r("td",{attrs:{width:"5%"}},["file"===e.itemType?r("div",{staticClass:"form-check"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.checked[e.item.id],expression:"form.checked[item.id]"}],staticClass:"valid",attrs:{id:"ch-"+e.item.id,type:"checkbox",name:"checkbox"},domProps:{checked:Array.isArray(e.form.checked[e.item.id])?e._i(e.form.checked[e.item.id],null)>-1:e.form.checked[e.item.id]},on:{change:[function(t){var r=e.form.checked[e.item.id],i=t.target,n=!!i.checked;if(Array.isArray(r)){var o=null,a=e._i(r,o);i.checked?a<0&&e.$set(e.form.checked,e.item.id,r.concat([o])):a>-1&&e.$set(e.form.checked,e.item.id,r.slice(0,a).concat(r.slice(a+1)))}else e.$set(e.form.checked,e.item.id,n)},e.onChange]}}),r("label",{staticClass:"form-check__label",attrs:{for:"ch-"+e.item.id}})]):e._e()]):e._e(),r("td",{staticClass:"align-middle"},[r("div",{staticClass:"d-flex align-items-center truncate"},[r("a",{staticClass:"link",attrs:{href:"file"===e.itemType?e.item.file_addr:"#",target:"file"===e.itemType?"_blank":"_self"},on:{click:function(t){return e.openFolder(t,e.item.id,e.item.file_addr,e.item.name)}}},[r("ion-icon",{staticClass:"m-r-1",attrs:{name:"folder"===e.itemType?"folder-outline":"document-outline",size:"small"}}),e._v(e._s(e.item.name))],1),e.disabled?r("span",{staticClass:"m-l-1"},[r("b-icon",{staticClass:"m-r-1",attrs:{icon:"arrow-counterclockwise",animation:"spin-reverse-pulse","font-scale":"1"}}),e._v("Zipping...")],1):e._e()])]),r("td",{staticClass:"align-middle text-right"},[e._v(e._s(e.item.owner))]),r("td",{staticClass:"align-middle text-right"},[r("div",[e._v(e._s(e._f("format_size")(e.item.size?e.item.size:0)))])]),r("td",{staticClass:"align-middle text-right"},[e._v(e._s(e.dateToHuman(e.item.updated_at)))]),r("td",{staticClass:"text-right"},[r("div",{staticClass:"actions"},[r("b-dropdown",{staticClass:"m-0 p-0",attrs:{size:"sm",variant:"none",right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[r("b-icon",{attrs:{icon:"three-dots"}})]},proxy:!0}])},[r("FoldersModalEdit",{attrs:{item:e.item,inline:!1}},[r("b-dropdown-item",[e._v("Edit")])],1),r("b-dropdown-item",{attrs:{disabled:e.disabled},on:{click:function(t){return e.zipping(e.item.id,e.item.name)}}},[e.disabled?r("b-icon",{staticClass:"m-r-1",attrs:{icon:"arrow-counterclockwise",animation:"spin-reverse-pulse","font-scale":"1"}}):e._e(),e._v("Download")],1),r("FoldersModalMoveTo",{attrs:{item:e.item,inline:!1},on:{movedConfirmed:e.moveToFileFolder}},[r("b-dropdown-item",[e._v("Move to")])],1),r("FilefoldersModalDelete",{attrs:{inline:!1},on:{deleteConfirmed:function(t){return e.deleteFileFolderItem(e.item.id,e.itemType)}}},[r("b-dropdown-item",{staticClass:"delete"},[e._v("Delete")])],1)],1)],1)])])},a=[],s=r("c973"),l=r.n(s),c=r("9523"),d=r.n(c),u=r("a34a"),f=r.n(u),m=r("2f62"),p=r("1315"),h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{"d-inline-block":e.inline}},[r("div",{directives:[{name:"b-modal",rawName:"v-b-modal",value:e.modalId,expression:"modalId"}],class:{"d-inline-block":e.inline}},[e._t("default")],2),r("b-modal",{staticClass:"fade",attrs:{id:e.modalId,title:"Move To"},on:{shown:e.getData}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-12 m-b-2"},[r("label",{staticClass:"form-label"},[e._v("Destination")]),r("b-form-select",{attrs:{errors:e.errors.destination,options:e.treeList},model:{value:e.file_folder.destination,callback:function(t){e.$set(e.file_folder,"destination",t)},expression:"file_folder.destination"}}),r("Errors",{attrs:{errors:e.errors.name}})],1)]),r("template",{slot:"modal-footer"},[r("button",{staticClass:"btn btn-link",on:{click:function(t){return e.$bvModal.hide(e.modalId)}}},[e._v("Cancel")]),r("button",{staticClass:"btn btn-dark",on:{click:e.submit}},[e._v("Confirm")])])],2)],1)},b=[],v=r("6bfc"),_=r("0c19");function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=function(){return Math.random().toFixed(10).toString().replace(".","")},g=function(e){return{id:e,label:e}},C={props:{inline:{type:Boolean,default:!0},item:{type:Object,required:!0}},components:{Errors:v["a"],ComboBox:_["a"]},data:function(){return{modalId:"modal_".concat(y()),file_folder:{destination:null},treeList:null,errors:[]}},computed:w(w({},Object(m["c"])({filefolders:"filefolders/filefolders"})),{},{destinationOptions:function(){return this.filefolders.folders.map((function(e){return{value:e.id,text:e.name}}))},linkToOptions:function(){return[w(w({},g("Projects")),{},{children:["Some project","Another","One"].map(g)}),w(w({},g("Annual Reviews")),{},{children:["Annual Review 2018","Annual Review 1337","Some Review"].map(g)}),w(w({},g("Policies")),{},{children:["Pol","Icy","Policy 3"].map(g)})]}}),methods:{submit:function(e){var t=this;return l()(f.a.mark((function r(){var i,n,o,a;return f.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.preventDefault(),t.file_folder.destination){r.next=4;break}return t.toast("Error","N - Required field",!0),r.abrupt("return");case 4:if(!t.item.file_addr){r.next=10;break}return i={file_doc:{file_folder_id:t.file_folder.destination}},n=new FormData,Object.keys(i.file_doc).map((function(e){return n.append("file_doc[".concat(e,"]"),i.file_doc[e])})),t.$store.dispatch("filefolders/updateFile",{id:t.item.id,data:n,action:"move"}).then((function(e){e.errors||t.toast("Success","File has been moved.")}))["catch"]((function(e){console.error(e),t.toast("Error","File has not been moved. Please try again.",!0)})),r.abrupt("return");case 10:return o={file_folder:{parent_id:t.file_folder.destination}},r.prev=11,r.next=14,t.$store.dispatch("filefolders/updateFolder",{id:t.item.id,data:o,action:"move"});case 14:if(a=r.sent,!a.errors){r.next=19;break}return t.toast("Error","Folder has not been moved. Please try again. ".concat(a.status),!0),Object.keys(a.errors).map((function(e){return a.errors[e].map((function(r){return t.toast("Error","".concat(e,": ").concat(r))}))})),r.abrupt("return");case 19:t.toast("Success","Folder has been moved."),t.$emit("movedConfirmed","test"),t.$bvModal.hide(t.modalId),r.next=27;break;case 24:r.prev=24,r.t0=r["catch"](11),t.toast("Error",r.t0.message,!0);case 27:case"end":return r.stop()}}),r,null,[[11,24]])})))()},getData:function(){var e=this;this.$store.dispatch("filefolders/getFileFoldersListTree",this.item.id).then((function(t){console.log(t),e.treeList=t.map((function(e){return{value:e[1],text:e[0]}}))}))["catch"]((function(t){console.error(t),e.treeList||(e.treeList=e.destinationOptions)}))}}},F=C,O=r("2877"),x=Object(O["a"])(F,h,b,!1,null,null,null),E=x.exports,j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{"d-inline-block":e.inline}},[r("div",{directives:[{name:"b-modal",rawName:"v-b-modal",value:e.modalId,expression:"modalId"}],class:{"d-inline-block":e.inline}},[e._t("default")],2),r("b-modal",{staticClass:"fade",attrs:{id:e.modalId,title:e.item.file_addr?"Edit File Name":"Edit Folder Name"}},[e.error?r("b-alert",{staticClass:"m-b-20",attrs:{variant:"danger",show:""}},[e._v(e._s(e.error))]):e._e(),r("div",{staticClass:"row"},[r("div",{staticClass:"col-12"},[r("label",{staticClass:"form-label"},[e._v("Name")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.fileFolder,expression:"fileFolder"}],ref:"input",staticClass:"form-control",attrs:{type:"text",placeholder:"Enter the name of your folder"},domProps:{value:e.fileFolder},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit.apply(null,arguments)},input:function(t){t.target.composing||(e.fileFolder=t.target.value)}}}),r("Errors",{attrs:{errors:e.errors.name}})],1)]),r("template",{slot:"modal-footer"},[r("button",{staticClass:"btn btn-link",on:{click:function(t){return e.$bvModal.hide(e.modalId)}}},[e._v("Cancel")]),r("button",{staticClass:"btn btn-dark",on:{click:e.submit}},[e._v("Save")])])],2)],1)},I=[],D=function(){return Math.random().toFixed(10).toString().replace(".","")},S={props:{inline:{type:Boolean,default:!0},item:{type:Object,required:!0}},components:{Errors:v["a"]},data:function(){return{modalId:"modal_".concat(D()),file_folder:{name:""},errors:[],error:""}},computed:{fileFolder:{get:function(){return this.item.name},set:function(e){this.file_folder.name=e}}},methods:{submit:function(e){var t=this;return l()(f.a.mark((function r(){var i,n,o,a;return f.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.preventDefault(),t.error="",t.file_folder.name){r.next=5;break}return t.error="Required field",r.abrupt("return");case 5:if(!(t.file_folder.name.length<=3)){r.next=8;break}return t.error="Name must be more than 3 characters.",r.abrupt("return");case 8:if(!t.item.file_addr){r.next=14;break}return i={file_doc:{name:t.file_folder.name}},n=new FormData,Object.keys(i.file_doc).map((function(e){return n.append("file_doc[".concat(e,"]"),i.file_doc[e])})),t.$store.dispatch("filefolders/updateFile",{id:t.item.id,data:n}).then((function(e){e.errors||t.toast("Success","File has been saved.")}))["catch"]((function(e){console.error(e),t.toast("Error","File has not been saved.")})),r.abrupt("return");case 14:return o={file_folder:{name:t.file_folder.name}},r.prev=15,r.next=18,t.$store.dispatch("filefolders/updateFolder",{id:t.item.id,data:o});case 18:if(a=r.sent,!a.errors){r.next=23;break}return t.toast("Error","Folder has not been saved. Please Try again. ".concat(a.status),!0),Object.keys(a.errors).map((function(e){return a.errors[e].map((function(r){return t.toast("Error","".concat(e,": ").concat(r))}))})),r.abrupt("return");case 23:a.errors||(t.toast("Success","Folder has been saved."),t.$emit("editConfirmed"),t.$bvModal.hide(t.modalId)),r.next=29;break;case 26:r.prev=26,r.t0=r["catch"](15),t.toast("Error",r.t0.message,!0);case 29:case"end":return r.stop()}}),r,null,[[15,26]])})))()}}},T=S,$=Object(O["a"])(T,j,I,!1,null,null,null),P=$.exports,M=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:{"d-inline-block":e.inline}},[i("div",{directives:[{name:"b-modal",rawName:"v-b-modal",value:e.modalId,expression:"modalId"}],class:{"d-inline-block":e.inline}},[e._t("default")],2),i("b-modal",{staticClass:"fade",attrs:{id:e.modalId,title:"Delete Document"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-1 text-center px-0"},[i("img",{attrs:{src:r("d1db"),width:"25",height:"25"}})]),i("div",{staticClass:"col"},[i("p",{staticClass:"paragraph m-b-10"},[e._v("Removing this document will delete any progress and tasks associated with the file.")]),i("p",{staticClass:"paragraph mb-0"},[i("b",[e._v("Do you want to continue?")])])])]),i("Errors",{attrs:{errors:e.errors.title}}),i("template",{slot:"modal-footer"},[i("button",{staticClass:"btn link mr-2",on:{click:function(t){return e.$bvModal.hide(e.modalId)}}},[e._v("Cancel")]),i("button",{staticClass:"btn btn-dark",on:{click:e.submit}},[e._v("Confirm")])])],2)],1)},z=[],R=function(){return Math.random().toFixed(10).toString().replace(".","")},N={props:{inline:{type:Boolean,default:!0}},data:function(){return{modalId:"modal_".concat(R()),errors:[]}},methods:{submit:function(e){e.preventDefault(),this.errors=[],this.$emit("deleteConfirmed"),this.$bvModal.hide(this.modalId)}}},L=N,A=Object(O["a"])(L,M,z,!1,null,null,null),B=A.exports;function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var J={name:"ReviewItem",props:["item","itemType","check"],components:{FoldersModalMoveTo:E,FoldersModalEdit:P,FilefoldersModalDelete:B},data:function(){return{form:{checked:[]},zipCounter:0,disabled:!1}},filters:{format_size:function(e){return e>=1e3?"".concat((e/1e3).toFixed(1)," MB"):"".concat(e," KB")}},methods:q(q(q({},Object(m["d"])({setCurrentReviewFolder:"filefolders/SET_CUREENT_FOLDER"})),Object(m["b"])({getFileFolders:"filefolders/getFileFolders",getCurrentReviewFileFoldersById:"filefolders/getFileFoldersById",deleteFileFolder:"filefolders/deleteFileFolder"})),{},{dateToHuman:function(e){var t=p["DateTime"].fromJSDate(new Date(e));return t.invalid?t.invalid?e:void 0:t.toFormat("dd/MM/yyyy")},openFolder:function(e,t,r,i){r||(e.preventDefault(),console.log("folderId",t),i&&this.$store.commit("filefolders/SET_CUREENT_FOLDER_NAME",i),this.getCurrentReviewFileFoldersById(t),this.setCurrentReviewFolder(t))},downloadFileFolder:function(e){},zipping:function(e,t){var r=this;return l()(f.a.mark((function i(){return f.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:return i.prev=2,r.disabled=!0,i.next=6,r.$store.dispatch("filefolders/startZipping",{id:e}).then((function(i){r.toast("Success","File has been downloaded."),setTimeout((function(){r.zippinTimerChecker(e,t),r.zipCounter++}),5e3)}))["catch"]((function(e){console.error(response),r.zipStatus=!1,r.disabled=!1}));case 6:i.next=11;break;case 8:i.prev=8,i.t0=i["catch"](2),r.toast("Error",i.t0.message,!0);case 11:case"end":return i.stop()}}),i,null,[[2,8]])})))()},zippinTimerChecker:function(e,t){var r=this;return l()(f.a.mark((function i(){return f.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,r.disabled=!0,i.next=4,r.$store.dispatch("filefolders/checkZipping",{id:e}).then((function(i){i.complete||setTimeout((function(){r.zippinTimerChecker(e,t),r.zipCounter++}),5e3),i.complete&&(r.zipStatus=!0,r.toast("Success","File has been downloaded."),r.download(i.path,"".concat(t," ").concat(e,".zip")),r.disabled=!1)}))["catch"]((function(e){console.error(e),r.zipStatus=!1,r.disabled=!1}));case 4:i.next=9;break;case 6:i.prev=6,i.t0=i["catch"](0),r.toast("Error",i.t0.message,!0);case 9:case"end":return i.stop()}}),i,null,[[0,6]])})))()},download:function(e,t){var r=document.createElement("a");r.href=e,r.setAttribute("download",t),r.click()},moveToFileFolder:function(e){console.log("move done")},deleteFileFolderItem:function(e,t){var r=this;return l()(f.a.mark((function i(){return f.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:try{r.deleteFileFolder({id:e,itemType:t}).then((function(e){return r.toast("Success","".concat(e.message))}))["catch"]((function(e){return r.toast("Error","Folder has not been deleted. Please try again.",!0)}))}catch(n){r.toast("Error",n.message,!0)}case 1:case"end":return i.stop()}}),i)})))()},onChange:function(e){var t={file:this.item,status:e};this.$emit("selectedItem",t)}})},Z=J,H=(r("0ce7"),Object(O["a"])(Z,o,a,!1,null,"3b51b2ff",null)),K=H.exports,G={components:{FilefoldersItem:K},props:["filefolders","check"],data:function(){return{sortOptions:{field:"progress",type:"number",reverse:!1}}},computed:{sortedReview:function(){var e=this.sortOptions;return this.filefolders.sort((function(t,r){if("number"===e.type)return e.reverse?r[e.field]-t[e.field]:t[e.field]-r[e.field];if("date"===e.type){var i=new Date(t[e.field]),n=new Date(r[e.field]);return e.reverse?n-i:i-n}if("string"===e.type){var o=t[e.field].toLowerCase(),a=r[e.field].toLowerCase();return e.reverse?o>a?-1:o<a?1:0:o<a?-1:o>a?1:0}}))}},methods:{sortSelect:function(e,t){var r=this.sortOptions;e!==r.field?this.sortOptions={field:e,type:t,reverse:!1}:this.sortOptions.reverse=!r.reverse},selectedItemUp:function(e){this.$emit("selectedItem",e)}}},Q=G,V=Object(O["a"])(Q,i,n,!1,null,null,null);t["a"]=V.exports}}]);
//# sourceMappingURL=chunk-13ff6386.1010ae42.js.map
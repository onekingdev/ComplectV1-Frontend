{"version":3,"sources":["webpack:///./src/specialist/projects/ProjectTimesheetsPage.vue?3545","webpack:///src/specialist/projects/ProjectTimesheetsPage.vue","webpack:///./src/specialist/projects/ProjectTimesheetsPage.vue?f089","webpack:///./src/specialist/projects/ProjectTimesheetsPage.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","projectUrl","scopedSlots","_u","key","fn","ref","project","title","directives","name","rawName","modifiers","staticClass","_v","timesheetsUrl","enrich","timesheets","_l","row","id","_s","_f","created_at","status","total_duration","total_due","payment_to_date","_e","today","entry","i","on","$event","removeRow","errors","model","value","callback","$$v","$set","expression","_n","addRow","totalDue","slot","$bvModal","hide","Object","assign","headers","saved","staticRenderFns","props","type","Number","required","data","initialEntry","isTableVisible","methods","map","time_logs_attributes","push","newEntryRow","splice","reloadTable","toast","setTimeout","computed","submitData","timesheet","$store","getters","url","Authorization","accessToken","component"],"mappings":"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","file":"js/chunk-2d0d7615.50c65ca4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Get',{attrs:{\"project\":_vm.projectUrl},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar project = ref.project;\nreturn [_c('Breadcrumbs',{attrs:{\"items\":['Projects', project.title, 'My Timesheet']}})]}}])}),_c('button',{directives:[{name:\"b-modal\",rawName:\"v-b-modal.timesheets-modal\",modifiers:{\"timesheets-modal\":true}}],staticClass:\"btn btn-dark\"},[_vm._v(\"Log Time\")]),(_vm.isTableVisible)?_c('Get',{attrs:{\"timesheets\":_vm.timesheetsUrl,\"callback\":_vm.enrich},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar timesheets = ref.timesheets;\nreturn [_c('table',{staticClass:\"table\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"Date of Entry\")]),_c('th',[_vm._v(\"Status\")]),_c('th',[_vm._v(\"Total Time\")]),_c('th',[_vm._v(\"Total Due\")]),_c('th',[_vm._v(\"Payment to Date\")]),_c('th')])]),_c('tbody',_vm._l((timesheets),function(row){return _c('tr',{key:row.id},[_c('td',[_vm._v(_vm._s(_vm._f(\"asDate\")(row.created_at)))]),_c('td',[_vm._v(_vm._s(row.status))]),_c('td',[_vm._v(_vm._s(_vm._f(\"minToHour\")(row.total_duration)))]),_c('td',[_vm._v(_vm._s(_vm._f(\"usdWhole\")(row.total_due)))]),_c('td',[_vm._v(_vm._s(_vm._f(\"usdWhole\")(row.payment_to_date)))]),_c('td',[_vm._v(\"...\")])])}),0)])]}}],null,false,3831883461)}):_vm._e(),_c('b-modal',{staticClass:\"fade\",attrs:{\"id\":\"timesheets-modal\",\"title\":\"Log Time\"}},[_c('label',{staticClass:\"form-label\"},[_vm._v(\"Date of Entry\")]),_c('p',[_vm._v(_vm._s(_vm._f(\"asDate\")(_vm.today)))]),_vm._l((_vm.entry.time_logs_attributes),function(row,i){return _c('div',{key:i,staticClass:\"row\"},[_c('div',{staticClass:\"col-sm-12\"},[_c('hr'),(i)?_c('span',{staticClass:\"float-right btn btn-danger btn-sm\",on:{\"click\":function($event){return _vm.removeRow(i)}}},[_vm._v(\"Ã—\")]):_vm._e(),_c('InputText',{attrs:{\"errors\":_vm.errors['time_logs.description'],\"placeholder\":\"Describe the task\"},model:{value:(row.description),callback:function ($$v) {_vm.$set(row, \"description\", $$v)},expression:\"row.description\"}},[_vm._v(\"Description\")])],1),_c('div',{staticClass:\"col-md-4\"},[_c('InputDate',{attrs:{\"errors\":_vm.errors['time_logs.date']},model:{value:(row.date),callback:function ($$v) {_vm.$set(row, \"date\", $$v)},expression:\"row.date\"}},[_vm._v(\"Date\")])],1),_c('div',{staticClass:\"col-md-4\"},[_c('InputNumber',{attrs:{\"errors\":_vm.errors['time_logs.hours']},model:{value:(row.hours),callback:function ($$v) {_vm.$set(row, \"hours\", _vm._n($$v))},expression:\"row.hours\"}},[_vm._v(\"Hours\")])],1),_c('div',{staticClass:\"col-md-4\"},[_c('InputNumber',{attrs:{\"errors\":_vm.errors['time_logs.minutes']},model:{value:(row.minutes),callback:function ($$v) {_vm.$set(row, \"minutes\", _vm._n($$v))},expression:\"row.minutes\"}},[_vm._v(\"Minutes\")])],1)])}),_c('hr'),_c('button',{staticClass:\"btn btn-outline-dark\",on:{\"click\":_vm.addRow}},[_vm._v(\"+ Add Entry\")]),_c('hr'),_c('p',{staticClass:\"text-right\"},[_vm._v(\"Total Due: \"+_vm._s(_vm._f(\"usdWhole\")(_vm.totalDue)))]),_c('template',{slot:\"modal-footer\"},[_c('button',{staticClass:\"btn btn-light\",on:{\"click\":function($event){return _vm.$bvModal.hide('timesheets-modal')}}},[_vm._v(\"Cancel\")]),_c('Post',{attrs:{\"action\":_vm.timesheetsUrl,\"model\":Object.assign({}, _vm.entry,{status:'pending'}),\"headers\":_vm.headers},on:{\"errors\":function($event){_vm.errors = $event},\"saved\":_vm.saved}},[_c('button',{staticClass:\"btn btn-outline-dark\"},[_vm._v(\"Save Draft\")])]),_c('Post',{attrs:{\"action\":_vm.timesheetsUrl,\"model\":Object.assign({}, _vm.entry,{status:'submitted'}),\"headers\":_vm.headers},on:{\"errors\":function($event){_vm.errors = $event},\"saved\":_vm.saved}},[_c('button',{staticClass:\"btn btn-dark\"},[_vm._v(\"Send\")])])],1)],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\n  div\n    Get(:project=\"projectUrl\"): template(v-slot=\"{project}\")\n      Breadcrumbs(:items=\"['Projects', project.title, 'My Timesheet']\")\n    button.btn.btn-dark(v-b-modal.timesheets-modal) Log Time\n    Get(v-if=\"isTableVisible\" :timesheets=\"timesheetsUrl\" :callback=\"enrich\"): template(v-slot=\"{timesheets}\")\n      table.table\n        thead\n          tr\n            th Date of Entry\n            th Status\n            th Total Time\n            th Total Due\n            th Payment to Date\n            th\n        tbody\n          tr(v-for=\"row in timesheets\" :key=\"row.id\")\n            td {{ row.created_at | asDate }}\n            td {{ row.status }}\n            td {{ row.total_duration | minToHour }}\n            td {{ row.total_due | usdWhole }}\n            td {{ row.payment_to_date | usdWhole }}\n            td ...\n    b-modal.fade(id=\"timesheets-modal\" title=\"Log Time\")\n      label.form-label Date of Entry\n      p {{ today | asDate }}\n      .row(v-for=\"(row, i) in entry.time_logs_attributes\" :key=\"i\")\n        .col-sm-12\n          hr\n          span.float-right.btn.btn-danger.btn-sm(v-if=\"i\" @click=\"removeRow(i)\") &times;\n          InputText(v-model=\"row.description\" :errors=\"errors['time_logs.description']\" placeholder=\"Describe the task\") Description\n        .col-md-4\n          InputDate(v-model=\"row.date\" :errors=\"errors['time_logs.date']\") Date\n        .col-md-4\n          InputNumber(v-model.number=\"row.hours\" :errors=\"errors['time_logs.hours']\") Hours\n        .col-md-4\n          InputNumber(v-model.number=\"row.minutes\" :errors=\"errors['time_logs.minutes']\") Minutes\n      hr\n      button.btn.btn-outline-dark(@click=\"addRow\") + Add Entry\n      hr\n      p.text-right Total Due: {{ totalDue | usdWhole }}\n      template(slot=\"modal-footer\")\n        button.btn.btn-light(@click=\"$bvModal.hide('timesheets-modal')\") Cancel\n        Post(:action=\"timesheetsUrl\" :model=\"{...entry,status:'pending'}\" :headers=\"headers\" @errors=\"errors = $event\" @saved=\"saved\")\n          button.btn.btn-outline-dark Save Draft\n        Post(:action=\"timesheetsUrl\" :model=\"{...entry,status:'submitted'}\" :headers=\"headers\" @errors=\"errors = $event\" @saved=\"saved\")\n          button.btn.btn-dark Send\n</template>\n\n<script>\nimport { DateTime } from 'luxon'\nimport { mapGetters } from 'vuex'\n\nconst initialEntry = () => ({ time_logs_attributes: [newEntryRow()] })\nconst newEntryRow = () => ({\n  description: null,\n  date: today(),\n  hours: 0,\n  minutes: 0\n})\nconst today = () => DateTime.local().toISODate()\nconst totalDuration = rows => rows.reduce((result, row) => result + 60 * (row.hours || 0) + (row.minutes || 0), 0)\nconst totalDue = (minutes, pricePerHour) => Math.ceil(minutes * (pricePerHour || 0))\n\nexport default {\n  props: {\n    id: {\n      type: Number,\n      required: true\n    }\n  },\n  data() {\n    return {\n      entry: initialEntry(),\n      errors: {},\n      isTableVisible: true\n    }\n  },\n  methods: {\n    enrich(timesheets) {\n      return timesheets.map(row => ({\n        ...row,\n        total_duration: totalDuration(row.time_logs),\n        total_due: totalDue(totalDuration(row.time_logs), row.hourly_rate),\n        payment_to_date: 0 // @todo payment_to_date calculation\n      }))\n    },\n    addRow() {\n      this.entry.time_logs_attributes.push(newEntryRow())\n    },\n    removeRow(i) {\n      this.entry.time_logs_attributes.splice(i, 1)\n    },\n    saved() {\n      this.reloadTable()\n      this.$bvModal.hide('timesheets-modal')\n      Object.assign(this.entry, initialEntry())\n      this.toast('Success', 'Time logged and awaiting approval')\n    },\n    reloadTable() {\n      this.isTableVisible = false, setTimeout(() => this.isTableVisible = true, 0)\n    }\n  },\n  computed: {\n    ...mapGetters(['accessToken']),\n    submitData() {\n      return {\n        timesheet: this.entry\n      }\n    },\n    projectUrl() {\n      return this.$store.getters.url('URL_API_MY_PROJECT', this.id)\n    },\n    timesheetsUrl() {\n      return this.$store.getters.url('URL_API_PROJECT_TIMESHEET', this.id)\n    },\n    today,\n    totalDue() {\n      return totalDue(totalDuration(this.entry.time_logs_attributes), this.entry.hourly_rate)\n    },\n    headers() {\n      return {\n        Authorization: this.accessToken\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProjectTimesheetsPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProjectTimesheetsPage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProjectTimesheetsPage.vue?vue&type=template&id=40023b1d&lang=pug&\"\nimport script from \"./ProjectTimesheetsPage.vue?vue&type=script&lang=js&\"\nexport * from \"./ProjectTimesheetsPage.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}
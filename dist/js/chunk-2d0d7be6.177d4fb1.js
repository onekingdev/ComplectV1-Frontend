(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d7be6"],{"77b2":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page"},[n("Get",{attrs:{currentBusiness:"/api/businesses/current"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.currentBusiness;return[n("div",{staticClass:"page-header"},[n("h2",{staticClass:"page-header__title"},[n("b",[t._v("Welcome, ")]),t._v(t._s(r.contact_first_name)+" "+t._s(r.contact_last_name))])]),n("div",{staticClass:"p-x-40 p-b-40"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"dashboard"},[n("div",{staticClass:"card calendar"},[n("Calendar",t._b({attrs:{etag:t.etag},on:{saved:t.newEtag}},"Calendar",{pdfUrl:t.pdfUrl},!1))],1),n("div",{staticClass:"card upcoming h-100"},[n("UpcomingTasks",{attrs:{etag:t.etag},on:{saved:t.newEtag}})],1)])])])])]}}])})],1)},a=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"card-header"},[n("div",{staticStyle:{"vertical-align":"middle"}},[n("h3",{staticClass:"calendar__title m-y-0"},[n("TaskFormModal",t._b({attrs:{id:"CalendarTaskFormModal"},on:{saved:function(e){return t.$emit("saved")}}},"TaskFormModal",t.nowEditingTask,!1)),t._v(t._s(t.currentMonth)),n("small",{staticClass:"float-right",staticStyle:{"vertical-align":"middle"}},[n("ion-icon",{staticClass:"m-x-1",attrs:{name:"chevron-back-outline"},on:{click:function(e){return e.preventDefault(),t.prev.apply(null,arguments)}}}),n("ion-icon",{attrs:{name:"chevron-forward-outline"},on:{click:function(e){return e.preventDefault(),t.next.apply(null,arguments)}}})],1)],1)]),n("Download",{staticClass:"d-none",attrs:{pdfUrl:t.pdfUrl}})],1),n("div",{staticClass:"card-body p-20"},[n("FullCalendar",{ref:"FullCalendar",attrs:{options:t.calendarOptions},scopedSlots:t._u([{key:"dayCellContent",fn:function(e){return[n("TaskFormModal",{attrs:{"remind-at":t.jsToSql(e.date)},on:{saved:function(e){return t.$emit("saved")}}},[n("a",{staticClass:"fc-daygrid-day-number",attrs:{href:""},domProps:{innerHTML:t._s(t.dayContent(e.date))},on:{click:function(t){t.preventDefault()}}})])]}},{key:"eventContent",fn:function(e){return[n("div",{staticClass:"fc-event-main-frame"},[n("div",{staticClass:"fc-event-title-container"},[n("div",{staticClass:"fc-event-title fc-sticky"},[t._l(e.event.extendedProps.icons,(function(e){return n("span",[n("ion-icon",{attrs:{name:e}}),t._v(" ")],1)})),e.event.extendedProps.remind_at?n("span",{staticClass:"pointer",on:{click:function(n){return t.openModal(e.event.extendedProps.taskId,e.event.extendedProps.oid)}}},[t._v(t._s(e.event.title))]):n("a",{attrs:{href:e.event.extendedProps.href,target:"_blank"}},[t._v(t._s(e.event.title))])],2)])])]}}])})],1)])},o=[],c=n("9523"),i=n.n(c),l=n("f5ff"),u=n("3cdd"),d=n("a20c"),f=n("1315"),p=n("05f4"),h=n("6f33"),v=n("a791");function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _="/api/reminders/",g=function(t){return f["DateTime"].fromJSDate(t).toSQLDate()},j={props:{pdfUrl:{type:String,required:!0},etag:Number},components:{FullCalendar:l["a"],TaskFormModal:h["a"],Download:v["a"]},data:function(){return{currentMonth:"",nowEditingTask:{taskId:null,occurenceId:null}}},methods:{openModal:function(t,e){var n=this;Object.assign(this.nowEditingTask,{taskId:t,occurenceId:e}),this.$nextTick((function(){return n.$bvModal.show("CalendarTaskFormModal")}))},dayContent:function(t){return f["DateTime"].fromJSDate(t).toFormat("d")},jsToSql:function(t){return g(t)},prev:function(){this.calendarObject.prev(),this.updateCurrentMonth()},next:function(){this.calendarObject.next(),this.updateCurrentMonth()},updateCurrentMonth:function(){this.currentMonth=f["DateTime"].fromJSDate(this.calendarObject.getDate()).toFormat("MMMM yyyy")},refetchEvents:function(){this.calendarObject.refetchEvents()}},mounted:function(){this.updateCurrentMonth()},computed:{calendarObject:function(){return this.$refs.FullCalendar.getApi()},calendarOptions:function(){var t=this;return{firstDay:1,dayMaxEvents:2,aspectRatio:1.09,plugins:[u["a"],d["a"]],events:function(e,n,r){var a=g(e.start)+"/"+g(e.end);fetch("".concat(t.$store.getters.backendUrl).concat(_).concat(a),t.$store.getters.authHeaders).then((function(t){return t.json()})).then((function(e){return n(e.tasks.concat(e.projects.map((function(e){return b(b({},e),{},{href:t.$store.getters.url("URL_PROJECT_SHOW",e.id)})}))).map((function(t){return b(b({},Object(p["i"])(t)),{},{classNames:[Object(p["c"])(t)]})})))}))["catch"](r)},headerToolbar:!1}}},watch:{etag:{handler:function(t,e){this.refetchEvents()}}}},k=j,y=n("2877"),C=Object(y["a"])(k,s,o,!1,null,null,null),O=C.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"card-header d-flex justify-content-between"},[n("h3",{staticClass:"upcoming__header m-y-0"},[t._v("Upcoming")]),n("TaskFormModal",{on:{saved:function(e){return t.$emit("saved")}}},[n("button",{staticClass:"btn btn-dark float-end"},[t._v("New Task")])])],1),n("div",{staticClass:"card-body p-x-20 p-y-30"},[n("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.upcoming_tasks_collapse",modifiers:{upcoming_tasks_collapse:!0}}],staticClass:"upcoming__title d-flex justify-content-between m-b-10",attrs:{role:"button"}},[t._v("Tasks"),n("ion-icon",{attrs:{name:"chevron-down-outline"}})],1),n("b-collapse",{attrs:{id:"upcoming_tasks_collapse",visible:!0}},[n("TaskTable",{staticClass:"upcoming__table",attrs:{tasks:t.tasks,shortTable:!0},on:{saved:function(e){return t.$emit("saved")}}}),t.tasks.length?n("div",{staticClass:"d-flex justify-content-end mb-2"},[n("router-link",{staticClass:"link upcoming__more",attrs:{to:"/business/tasks"}},[t._v("More")])],1):t._e()],1),n("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.upcoming_projects_collapse",modifiers:{upcoming_projects_collapse:!0}}],staticClass:"upcoming__title d-flex justify-content-between m-b-10",attrs:{role:"button"}},[t._v("Projects"),n("ion-icon",{attrs:{name:"chevron-down-outline"}})],1),n("b-collapse",{attrs:{id:"upcoming_projects_collapse",visible:!0}},[n("ProjectTable",{attrs:{projects:t.projects}}),t.projects.length?n("div",{staticClass:"d-flex justify-content-end"},[n("router-link",{staticClass:"link upcoming__more",attrs:{to:"/business/projects"}},[t._v("More")])],1):t._e()],1)],1)])},T=[],D=n("6ab6"),M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",{staticClass:"table task_table short-table"},[t._m(0),n("tbody",t._l(t.projectList,(function(e,r){return n("tr",{key:r},[n("td",[n("router-link",{staticClass:"link",attrs:{to:e.href}},[t._v(t._s(e.title))])],1),n("td",{staticClass:"text-right due-date",class:{overdue:t.isOverdue(e)}},[t.isOverdue(e)?n("b-icon",{staticClass:"mr-2",attrs:{icon:"exclamation-triangle-fill",variant:"warning"}}):t._e(),t._v(t._s(t._f("asDate")(e.ends_on)))],1)])})),0)])},P=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("Name")]),n("th",{staticClass:"text-right"},[t._v("Due date")])])])}];function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={props:{projects:{type:Array,required:!0}},methods:{isOverdue:p["d"]},computed:{projectList:function(){var t=this;return this.projects.map((function(e){return $($({},Object(p["i"])(e)),{},{href:t.$store.getters.url("URL_PROJECT_SHOW",e.id)})}))}}},S=E,U=Object(y["a"])(S,M,P,!1,null,null,null),F=U.exports,L=5,H="/api/reminders/",J="/api/overdue_reminders",N={props:{etag:Number},data:function(){return{tasks:[],projects:[]}},created:function(){this.refetch()},methods:{refetch:function(){var t=this,e=f["DateTime"].local().toSQLDate()+"/"+f["DateTime"].local().plus({days:7}).toSQLDate(),n=[],r=[];fetch(this.$store.getters.backendUrl+J,this.$store.getters.authHeaders).then((function(t){return t.json()})).then((function(t){n=t.tasks})).then(fetch("".concat(this.$store.getters.backendUrl).concat(H).concat(e),this.$store.getters.authHeaders).then((function(t){return t.json()})).then((function(e){n=n.concat(e.tasks),r=e.projects,t.tasks=n.filter((function(t){return!t.done_at})),t.projects=r.slice(0,L)})))}},components:{TaskFormModal:h["a"],TaskTable:D["a"],ProjectTable:F},watch:{etag:{handler:function(t,e){this.refetch()}}}},I=N,R=Object(y["a"])(I,w,T,!1,null,null,null),q=R.exports,Q="/api/local_projects/",W="/reminders.csv",A={data:function(){return{etag:Math.random(),projects:[]}},methods:{newEtag:function(){this.etag=Math.random()},refetch:function(){var t=this;fetch(this.$store.getters.backendUrl+Q,this.$store.getters.authHeaders).then((function(t){return t.json()})).then((function(e){return t.projects=e}))}},created:function(){this.refetch()},computed:{pdfUrl:function(){return W}},components:{Calendar:O,UpcomingTasks:q}},B=A,G=Object(y["a"])(B,r,a,!1,null,null,null);e["default"]=G.exports}}]);
//# sourceMappingURL=chunk-2d0d7be6.177d4fb1.js.map
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c42b01c"],{"14f3":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page"},[t.shortTable?t._e():r("div",{staticClass:"page-header"},[r("h2",{staticClass:"page-header__title"},[t._v("Tasks")]),r("div",{staticClass:"page-header__actions"},[t.shortTable?t._e():r("a",{staticClass:"btn btn-default m-r-1 d-none",attrs:{href:t.pdfUrl,target:"_blank"}},[t._v("Download")]),r("TaskFormModal",{on:{saved:function(e){return t.refetch()}}},[r("a",{staticClass:"btn btn-dark"},[t._v("New Task")])])],1)]),r("div",{staticClass:"card-body white-card-body card-body_full-height p-x-40"},[t.shortTable?t._e():r("div",{staticClass:"row mb-3"},[r("div",{staticClass:"col"},[r("div",[r("b-dropdown",{staticClass:"actions__dropdown actions__dropdown_tasks m-r-1",attrs:{variant:"default"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t._v("Show: "+t._s(t._f("capitalize")(t.sortedByNameGeneral))),r("ion-icon",{staticClass:"ml-2",attrs:{name:"chevron-down-outline",size:"small"}})]},proxy:!0}],null,!1,4232157971)},[r("b-dropdown-item",{on:{click:function(e){return t.sortBy("all")}}},[t._v("All Tasks")]),r("b-dropdown-item",{on:{click:function(e){return t.sortBy("overdue")}}},[t._v("Overdue")]),r("b-dropdown-item",{on:{click:function(e){return t.sortBy("completed")}}},[t._v("Completed")])],1),r("b-dropdown",{staticClass:"actions__dropdown actions__dropdown_links m-r-1",attrs:{variant:"default"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t._v(t._s(t._f("linkableTypeCorrector")(t._f("capitalize")(t.sortedByNameAdditional)))),r("ion-icon",{staticClass:"ml-2",attrs:{name:"chevron-down-outline",size:"small"}})]},proxy:!0}],null,!1,128449830)},[r("b-dropdown-item",{on:{click:function(e){return t.sortByType("all")}}},[t._v("All Links")]),r("b-dropdown-item",{on:{click:function(e){return t.sortByType("LocalProject")}}},[t._v("Projects")]),r("b-dropdown-item",{on:{click:function(e){return t.sortByType("CompliancePolicy")}}},[t._v("Policies")]),r("b-dropdown-item",{on:{click:function(e){return t.sortByType("AnnualReport")}}},[t._v("Internal Reviews")])],1),r("b-dropdown",{staticClass:"actions__dropdown d-none",attrs:{variant:"default"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t._v(t._s(t.perPage)+" results"),r("ion-icon",{staticClass:"ml-2",attrs:{name:"chevron-down-outline",size:"small"}})]},proxy:!0}],null,!1,1936447672)},[r("b-dropdown-item",{on:{click:function(e){t.perPage=5}}},[t._v("5")]),r("b-dropdown-item",{on:{click:function(e){t.perPage=10}}},[t._v("10")]),r("b-dropdown-item",{on:{click:function(e){t.perPage=15}}},[t._v("15")]),r("b-dropdown-item",{on:{click:function(e){t.perPage=20}}},[t._v("20")])],1)],1)])]),r("div",{staticClass:"row"},[r("div",{staticClass:"col",class:t.shortTable?"p-0":""},[r("TaskTable",{staticClass:"m-b-40",attrs:{shortTable:t.shortTable,tasks:t.sortedTasks,perPage:t.perPage,currentPage:t.currentPage},on:{saved:t.refetch}}),!t.shortTable&&t.sortedTasks.length>t.perPage?r("b-pagination",{attrs:{"total-rows":t.rows,"per-page":t.perPage,shortTable:!t.shortTable,"aria-controls":"tasks-table"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)]),t.loading?r("div",{staticClass:"row h-100"},[r("div",{staticClass:"col h-100 text-center"},[r("Loading",{attrs:{absolute:!0}})],1)]):t._e(),t.sortedTasks.length||t.loading?t._e():r("div",{staticClass:"row h-100"},[r("div",{staticClass:"col h-100 text-center"},[r("EmptyState",{attrs:{name:"Tasks"}})],1)])])])},s=[],a=r("9523"),o=r.n(a),i=r("c973"),c=r.n(i),l=r("a34a"),d=r.n(l),u=r("2f62"),p=r("1315"),m=r("05f4"),f=r("e829"),h=r("90ca"),b=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("table",{staticClass:"table task_table",attrs:{"per-page":t.perPage,"current-page":t.currentPage}},[r("thead",[r("tr",[r("th",[t._v("Name"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),t.shortTable?t._e():r("th",{on:{click:function(e){return t.sortSelect("body","string")}}},[t._v("Linked to"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),t.shortTable?t._e():r("th",{on:{click:function(e){return t.sortSelect("linkable_type","string")}}},[t._v("Assignee"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),t.shortTable?t._e():r("th",{staticClass:"text-right",on:{click:function(e){return t.sortSelect("updated_at","date")}}},[t._v("Start date"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{staticClass:"text-right",on:{click:function(e){return t.sortSelect("created_at","date")}}},[t._v("Due date"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),t.shortTable?t._e():r("th",{staticClass:"d-none text-right",on:{click:function(e){return t.sortSelect("files","number")}}},[t._v("Files"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),t.shortTable?t._e():r("th",{staticClass:"d-none text-right",on:{click:function(e){return t.sortSelect("comments","number")}}},[t._v("Comments"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{staticClass:"text-right",attrs:{width:"35px"}})])]),t.sortedTaskLimited?r("tbody",t._l(t.sortedTaskLimited,(function(e){return r("TaskItem",{key:e.id,attrs:{item:e,shortTable:t.shortTable},on:{saved:function(e){return t.$emit("saved")}}})})),1):t._e()])},v=[],_=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",[r("td",[r("div",{staticClass:"name"},[r("b-icon",{staticClass:"pointer m-r-1",class:{done_task:t.item.done_at},attrs:{"font-scale":"1",icon:t.item.done_at?"check-circle-fill":"check-circle"},on:{click:function(e){return t.toggleDone(t.item)}}}),r("TaskFormModal",{staticClass:"link",attrs:{"task-id":t.item.id},on:{saved:function(e){return t.$emit("saved")}}},[t.item.done_at?r("s",[t._v(t._s(t.item.body))]):r("span",[t._v(t._s(t.item.body))])])],1)]),t.shortTable?t._e():r("td",[r("div",{staticClass:"d-flex align-items-center"},[t.linkedTo(t.item)?r("ion-icon",{staticClass:"mr-1",class:t.linkedToClass(t.item),attrs:{name:t.linkedTo(t.item)}}):t._e(),t.item.linkable_type?r("div",{staticClass:"link"},[t._v(t._s(t._f("linkableTypeCorrector")(t.item.linkable_type)))]):r("span",[t._v("---")])],1)]),t.shortTable?t._e():r("td",[t._v(t._s(t.item.assignee?t.item.assignee:"---"))]),t.shortTable?t._e():r("td",{staticClass:"text-right"},[t._v(t._s(t._f("asDate")(t.item.remind_at)))]),r("td",{staticClass:"text-right",class:{overdue:t.isOverdue(t.item)}},[t.isOverdue(t.item)?r("b-icon",{staticClass:"mr-2",attrs:{icon:"exclamation-triangle-fill",variant:"warning"}}):t._e(),t.isRepeat(t.item)?r("ion-icon",{staticClass:"text-dark mr-2",attrs:{name:"repeat-outline"}}):t._e(),t._v(t._s(t._f("asDate")(t.item.end_date)))],1),t.shortTable?t._e():r("td",{staticClass:"d-none text-right"},[t._v("0")]),t.shortTable?t._e():r("td",{staticClass:"d-none text-right"},[t._v("0")]),t.shortTable?t._e():r("td",{staticClass:"text-right"},[r("b-dropdown",{staticClass:"m-0 p-0",attrs:{size:"xs",variant:"none",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[r("b-icon",{attrs:{icon:"three-dots"}})]},proxy:!0}],null,!1,2038261878)},[r("TaskFormModal",{attrs:{"task-id":t.item.id},on:{saved:function(e){return t.$emit("saved")}}},[r("b-dropdown-item",[t._v("Edit")])],1),r("TaskDeleteConfirmModal",{attrs:{inline:!1},on:{deleteConfirmed:function(e){return t.deleteTask(t.item)}}},[r("b-dropdown-item",[t._v("Delete")])],1)],1)],1)])},k=[],g=r("6f33"),y=r("4e64"),T={name:"TaskItem",props:{item:{type:Object,required:!0},shortTable:{type:Boolean,default:!1}},components:{TaskFormModal:g["a"],TaskDeleteConfirmModal:y["a"]},computed:{},methods:{isRepeat:m["e"],isOverdue:m["d"],linkedTo:m["f"],linkedToClass:m["g"],toggleDone:function(t){var e=this;return c()(d.a.mark((function r(){var n,s,a,o,i,c;return d.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=Object(m["h"])(t.id),s=n.taskId,a=n.oid,o=null!==a?"&oid=".concat(a):"",i=null!==a?"&src_id=".concat(t.id):"",c=(!t.done_at).toString(),r.prev=4,r.next=7,e.$store.dispatch("reminders/updateTaskStatus",{id:s,done:c,oidParam:o,src_id_params:i}).then((function(t){return e.toast("Success","Updated!")}))["catch"]((function(t){return e.toast("Error","Something wrong! ".concat(t.message),!0)}));case 7:r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](4),console.error("error catch in task Item",r.t0);case 12:case"end":return r.stop()}}),r,null,[[4,9]])})))()},deleteTask:function(t){var e=this,r=t.id;this.$store.dispatch("reminders/deleteTask",{id:r}).then((function(t){return e.toast("Success","The task deleted!")}))["catch"]((function(t){return e.toast("Error","Something wrong! ".concat(t.message),!0)}))}},filters:{linkableTypeCorrector:function(t){return"AnnualReport"===t&&(t="Internal Review"),t.replace(/[A-Z]/g," $&")}}},C=T,w=r("2877"),P=Object(w["a"])(C,_,k,!1,null,null,null),x=P.exports;function O(t,e,r){return t.slice((r-1)*e,r*e)}var j={components:{TaskItem:x},props:{tasks:{type:Array,required:!0},shortTable:{type:Boolean,default:!1},perPage:{type:Number,default:1},currentPage:{type:Number,default:1}},data:function(){return{sortOptions:{field:"files",type:"number",reverse:!1}}},computed:{sortedTask:function(){var t=this.sortOptions;return this.tasks.sort((function(e,r){if("number"===t.type)return t.reverse?r[t.field]-e[t.field]:e[t.field]-r[t.field];if("date"===t.type){var n=new Date(e[t.field]),s=new Date(r[t.field]);return t.reverse?s-n:n-s}if("string"===t.type){var a=e[t.field].toLowerCase(),o=r[t.field].toLowerCase();return t.reverse?a>o?-1:a<o?1:0:a<o?-1:a>o?1:0}}))},sortedTaskLimited:function(){return O(this.sortedTask,this.perPage,this.currentPage)}},methods:{sortSelect:function(t,e){var r=this.sortOptions;t!==r.field?this.sortOptions={field:t,type:e,reverse:!1}:this.sortOptions.reverse=!r.reverse}}},S=j,B=(r("6363"),Object(w["a"])(S,b,v,!1,null,"0e7124be",null)),D=B.exports;function L(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function A(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?L(Object(r),!0).forEach((function(e){o()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var $="/reminders.csv",E={props:{shortTable:{type:Boolean,default:!1}},components:{Loading:f["a"],EmptyState:h["a"],TaskTable:D,TaskFormModal:g["a"]},data:function(){return{perPage:10,currentPage:1,toggleModal:!1,sortedBy:"all",sortedByLinkedTo:"all",sortedByNameGeneral:"All Tasks",sortedByNameAdditional:"All Links",projects:[]}},mounted:function(){this.refetch()},methods:{refetch:function(){var t=this;return c()(d.a.mark((function e(){var r;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r=p["DateTime"].local().minus({years:10}).toSQLDate()+"/"+p["DateTime"].local().plus({years:10}).toSQLDate(),e.next=4,t.$store.dispatch("reminders/getTasksByDate",r).then((function(e){return t.projects=e.projects||[]}))["catch"]((function(t){return console.error("error",t)}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),t.toast("Error",e.t0.message,!0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()},sortBy:function(t){this.sortedBy=t,this.sortedByNameGeneral=t},sortByType:function(t){this.sortedByLinkedTo=t,this.sortedByNameAdditional=t}},computed:A(A({},Object(u["c"])({tasks:"reminders/tasks"})),{},{pdfUrl:function(){return $},loading:function(){return this.$store.getters.loading},rows:function(){return this.tasks.length},sortedTasks:function(){var t,e=this.sortedBy,r=this.sortedByLinkedTo;return e&&("completed"===e&&(t=this.tasks.filter((function(t){return t.done_at}))),"overdue"===e&&(t=this.tasks.filter((function(t){return Object(m["d"])(t)}))),"all"===e&&(t=this.tasks)),r&&("LocalProject"!==r&&"CompliancePolicy"!==r&&"AnnualReport"!==r||(t=t.filter((function(t){return t.linkable_type===r}))),"all"===r&&(t=t||this.tasks)),t||this.tasks}}),filters:{capitalize:function(t){return t?(t=t.toString(),t.charAt(0).toUpperCase()+t.slice(1)):""},linkableTypeCorrector:function(t){return"LocalProject"===t&&(t="Projects"),"CompliancePolicy"===t&&(t="Policies"),"AnnualReport"===t&&(t="Internal Review"),t.replace(/[A-Z]/g," $&")}}},N=E,R=Object(w["a"])(N,n,s,!1,null,null,null);e["default"]=R.exports},6363:function(t,e,r){"use strict";r("7b0b")},"7b0b":function(t,e,r){}}]);
//# sourceMappingURL=chunk-3c42b01c.163ca9c8.js.map
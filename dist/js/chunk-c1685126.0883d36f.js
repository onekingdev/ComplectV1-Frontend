(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1685126"],{"1c31":function(e,t,r){"use strict";r("a16c")},a16c:function(e,t,r){},aa71:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page",on:{mouseover:e.mouseOver}},[r("div",{staticClass:"page-header grey-border-bottom"},[r("h2",{staticClass:"page-header__title"},[e._v(e._s(e.pageTitle))]),r("div",{staticClass:"page-header__actions"},[r("button",{staticClass:"btn btn-default",attrs:{disabled:e.disabled},on:{click:e.zipping}},[e.disabled?r("b-icon",{staticClass:"m-r-1",attrs:{icon:"arrow-counterclockwise",animation:"spin-reverse-pulse","font-scale":"1"}}):e._e(),e._v("Download")],1)])]),r("div",{staticClass:"card-body white-card-body card-body_full-height p-x-40"},[r("div",{staticClass:"d-flex align-items-center mb-2"},[r("h4",{staticClass:"font-16 mb-2 cursor-pointer",on:{click:e.backToRoot}},[e._v("All Documents"),e.currentFolderName?r("span",{staticClass:"separator"},[e._v(" / ")]):e._e(),e.currentFolderName?r("span",[e._v(e._s(e.currentFolderName))]):e._e()])]),r("div",{staticClass:"d-flex mb-2"},[r("input",{ref:"inputFile",attrs:{type:"file",hidden:""},on:{change:e.uploadFile}}),r("b-button",{staticClass:"m-r-1",attrs:{variant:"dark"},on:{click:e.selectFile}},[e._v("Upload")]),r("FoldersModalCreate",[r("b-button",{staticClass:"btn btn-default",attrs:{variant:"light"}},[e._v("New Folder")])],1)],1),r("div",{staticClass:"d-block"},[r("Loading"),!e.loading&&e.filefolders.files&&e.filefolders.folders?r("FilefoldersTable",{attrs:{filefolders:e.filefolders}}):e._e(),!e.loading&&e.filefolders.files.length<1&&e.filefolders.folders.length<1?r("EmptyState"):e._e()],1)])])},a=[],o=r("c973"),s=r.n(o),i=r("9523"),l=r.n(i),c=r("a34a"),d=r.n(c),u=r("2f62"),f=r("e829"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{"d-inline-block":e.inline}},[r("div",{directives:[{name:"b-modal",rawName:"v-b-modal",value:e.modalId,expression:"modalId"}],class:{"d-inline-block":e.inline}},[e._t("default")],2),r("b-modal",{staticClass:"fade",attrs:{id:e.modalId,title:"New Folder"}},[e.error?r("b-alert",{staticClass:"m-b-20",attrs:{variant:"danger",show:""}},[e._v(e._s(e.error))]):e._e(),r("div",{staticClass:"row"},[r("div",{staticClass:"col-12"},[r("label",{staticClass:"form-label"},[e._v("Name")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.file_folder.name,expression:"file_folder.name"}],ref:"input",staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.file_folder.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.file_folder,"name",t.target.value)}}}),r("Errors",{attrs:{errors:e.errors.name}})],1)]),r("template",{slot:"modal-footer"},[r("button",{staticClass:"btn btn-link",on:{click:function(t){return e.$bvModal.hide(e.modalId)}}},[e._v("Cancel")]),r("button",{staticClass:"btn btn-dark",on:{click:e.submit}},[e._v("Create")])])],2)],1)},b=[],m=r("6bfc");function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(){return Math.random().toFixed(10).toString().replace(".","")},F={props:{inline:{type:Boolean,default:!0}},components:{Errors:m["a"]},data:function(){return{modalId:"modal_".concat(g()),file_folder:{name:""},errors:{},error:""}},computed:v({},Object(u["c"])({parentId:"filefolders/currentFolder"})),methods:v(v({},Object(u["b"])({createFolder:"filefolders/createFolder"})),{},{submit:function(e){var t=this;return s()(d.a.mark((function r(){var n;return d.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.preventDefault(),t.error="",t.file_folder.name){r.next=5;break}return t.error="Required field",r.abrupt("return");case 5:if(!(t.file_folder.name.length<=3)){r.next=8;break}return t.error="Name must have more than 3 characters.",r.abrupt("return");case 8:return t.parentId&&(t.file_folder.parent_id=t.parentId),r.prev=9,r.next=12,t.createFolder(t.file_folder);case 12:if(n=r.sent,!n.errors){r.next=17;break}return t.toast("Error","Folder has not been created. Please try again.",!0),Object.keys(n.errors).map((function(e){return n.errors[e].map((function(r){return t.toast("Error","".concat(e,": ").concat(r))}))})),r.abrupt("return");case 17:n.errors||(t.toast("Success","Folder has been created."),t.$emit("saved"),t.$bvModal.hide(t.modalId),t.file_folder.name=""),r.next=23;break;case 20:r.prev=20,r.t0=r["catch"](9),t.toast("Error",r.t0.message,!0);case 23:case"end":return r.stop()}}),r,null,[[9,20]])})))()}})},_=F,w=r("2877"),k=Object(w["a"])(_,p,b,!1,null,null,null),O=k.exports,y=r("97af"),C=r("90ca");function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j={components:{Loading:f["a"],FoldersModalCreate:O,FilefoldersTable:y["a"],EmptyState:C["a"]},data:function(){return{pageTitle:"Books and Records",file:null,inputFile:null,disabled:!1,zipStatus:!1,zipCounter:0,pageFolderName:"",refreshTimer:0}},created:function(){},methods:E(E({},Object(u["b"])({startZipping:"filefolders/startZipping",getFileFoldersById:"filefolders/getFileFoldersById"})),{},{selectFile:function(){var e=this.$refs.inputFile;e.click(),this.file=this.$refs.inputFile.files[0]},uploadFile:function(){var e=this;this.file=this.$refs.inputFile.files[0];var t={file_doc:{file:this.file,name:this.file.name}};this.currentFolderId&&(t.file_doc.file_folder_id=this.currentFolderId);var r=new FormData;Object.keys(t.file_doc).map((function(e){return r.append("file_doc[".concat(e,"]"),t.file_doc[e])})),this.$store.dispatch("filefolders/uploadFile",r).then((function(t){t.errors||e.toast("Success","File has been uploaded.")}))["catch"]((function(t){console.error(t),e.toast("Error","File has been not been uploaded. Please try again",!0),e.zipStatus=!1,e.disabled=!1}))},zipping:function(){var e=this;return s()(d.a.mark((function t(){return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.currentFolderId){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e.disabled=!0,t.next=6,e.$store.dispatch("filefolders/startZipping").then((function(t){e.toast("Success","File has been downloaded."),setTimeout((function(){e.zippinTimerChecker(),e.zipCounter++}),5e3)}))["catch"]((function(t){console.error(response),e.zipStatus=!1,e.disabled=!1}));case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](2),e.toast("Error",t.t0.message,!0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))()},zippinTimerChecker:function(){var e=this;return s()(d.a.mark((function t(){return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.disabled=!0,t.next=4,e.$store.dispatch("filefolders/checkZipping").then((function(t){t.complete||setTimeout((function(){e.zippinTimerChecker(),e.zipCounter++}),5e3),t.complete&&(e.zipStatus=!0,e.toast("Success","File has been downloaded."),e.download(t.path,"Books and Records ".concat(e.currentFolderId,".zip")),e.disabled=!1)}))["catch"]((function(e){return console.error(response)}));case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.toast("Error",t.t0.message,!0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},download:function(e,t){var r=document.createElement("a");r.href=e,r.setAttribute("download",t),r.click()},backToRoot:function(e){var t=this;return s()(d.a.mark((function e(){return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("filefolders/getFileFolders").then((function(){t.$store.commit("filefolders/SET_CUREENT_FOLDER",null),t.$store.commit("filefolders/SET_CUREENT_FOLDER_NAME",null)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),t.toast("Error",e.t0.message,!0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},mouseOver:function(e){e&&this.refreshTimer++,300===this.refreshTimer&&(this.refreshFolders(),this.refreshTimer=0)},refreshFolders:function(){var e=this;return s()(d.a.mark((function t(){return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("filefolders/getFileFolders");case 2:case"end":return t.stop()}}),t)})))()}}),computed:E({loading:function(){return this.$store.getters.loading}},Object(u["c"])({filefolders:"filefolders/filefolders",currentFileFolders:"filefolders/currentFileFolders",currentFolderId:"filefolders/currentFolder",currentFolderName:"filefolders/currentFolderName"})),mounted:function(){var e=this;return s()(d.a.mark((function t(){var r;return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,r=window.location.pathname.match(/\d+/g),r){t.next=5;break}return t.next=5,e.$store.dispatch("filefolders/getFileFolders");case 5:if(!r){t.next=9;break}return t.next=8,e.getFileFoldersById(r[0]);case 8:e.$store.commit("filefolders/SET_CUREENT_FOLDER",r[0]);case 9:t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),console.error(t.t0),e.toast("Error",t.t0.message,!0,!0);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()}},T=j,P=(r("1c31"),Object(w["a"])(T,n,a,!1,null,null,null));t["default"]=P.exports},d1db:function(e,t,r){e.exports=r.p+"img/error_20.5080af0b.svg"}}]);
//# sourceMappingURL=chunk-c1685126.0883d36f.js.map
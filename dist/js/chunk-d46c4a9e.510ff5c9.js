(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d46c4a9e"],{"0f91":function(e,t,r){},"2a31":function(e,t,r){"use strict";r("8a45")},"57d3":function(e,t,r){"use strict";r("0f91")},"5a64":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"d-inline-block":e.inline}},[a("div",{directives:[{name:"b-modal",rawName:"v-b-modal",value:e.modalId,expression:"modalId"}],class:{"d-inline-block":e.inline}},[e._t("default")],2),a("b-modal",{staticClass:"fade",attrs:{id:e.modalId,title:"Delete Internal Review"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-1 text-center px-0"},[a("img",{attrs:{src:r("d1db"),width:"25",height:"25"}})]),a("div",{staticClass:"col"},[a("p",{staticClass:"paragraph m-b-10"},[e._v("Removing this internal review will delete any progress and tasks associated with the file.")]),a("p",{staticClass:"paragraph mb-0"},[a("b",[e._v("Do you want to continue?")])])])]),a("Errors",{attrs:{errors:e.errors.title}}),a("template",{slot:"modal-footer"},[a("button",{staticClass:"btn btn-link mr-2",on:{click:function(t){return e.$bvModal.hide(e.modalId)}}},[e._v("Cancel")]),a("button",{staticClass:"btn btn-dark",on:{click:e.submit}},[e._v("Confirm")])])],2)],1)},n=[],i=function(){return Math.random().toFixed(10).toString().replace(".","")},s={props:{inline:{type:Boolean,default:!0}},data:function(){return{modalId:"modal_".concat(i()),errors:[]}},methods:{submit:function(e){e.preventDefault(),this.errors=[],this.$emit("deleteConfirmed"),this.$bvModal.hide(this.modalId)}}},o=s,l=r("2877"),c=Object(l["a"])(o,a,n,!1,null,null,null);t["a"]=c.exports},"5aec":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page"},[r("div",{staticClass:"page-header"},[r("h2",{staticClass:"page-header__title"},[e._v("Internal Reviews")]),r("div",{staticClass:"page-header__actions"},[r("AnnualModalCreate",{attrs:{reviews:e.reviews}},[r("button",{staticClass:"btn btn-dark float-end"},[e._v("New Review")])])],1)]),r("div",{staticClass:"card-body white-card-body card-body_full-height p-x-40"},[r("Notifications",{staticClass:"m-b-20",attrs:{notify:e.notify}},[r("a",{staticClass:"btn btn-default",attrs:{href:"https://www.sec.gov/exams",target:"_blank"}},[e._v("View")])]),r("p",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],domProps:{innerHTML:e._s(e.noticeText)}}),r("Loading"),e.loading?e._e():r("ReviewTable",{attrs:{reviews:e.reviews}}),e.reviews.length||e.loading?e._e():r("div",{staticClass:"row h-100"},[r("div",{staticClass:"col h-100 text-center"},[r("EmptyState")],1)])],1)])},n=[],i=r("c973"),s=r.n(i),o=r("9523"),l=r.n(o),c=r("a34a"),d=r.n(c),u=r("8622"),v=r("2f62"),f=r("e829"),m=r("90ca"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{"d-inline-block":e.inline}},[r("div",{directives:[{name:"b-modal",rawName:"v-b-modal",value:e.modalId,expression:"modalId"}],class:{"d-inline-block":e.inline}},[e._t("default")],2),r("b-modal",{staticClass:"fade",attrs:{id:e.modalId,title:"New Review"},on:{close:e.hideModal}},[e.reviewsOptions&&e.reviewsOptions.length?r("div",{staticClass:"row m-b-1"},[r("div",{staticClass:"col-12"},[r("label",{staticClass:"form-label"},[e._v("Template")]),r("b-form-select",{attrs:{options:e.reviewsOptions},model:{value:e.reviewSelected,callback:function(t){e.reviewSelected=t},expression:"reviewSelected"}})],1)]):e._e(),r("div",{staticClass:"row"},[r("div",{staticClass:"col-12"},[r("label",{staticClass:"form-label"},[e._v("Name")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.annual_review.name,expression:"annual_review.name"}],ref:"input",staticClass:"form-control",attrs:{type:"text",placeholder:"Enter the name of your review"},domProps:{value:e.annual_review.name},on:{input:function(t){t.target.composing||e.$set(e.annual_review,"name",t.target.value)}}}),r("Errors",{attrs:{errors:e.errors.name}})],1)]),r("div",{staticClass:"row m-t-1"},[r("div",{staticClass:"col-6"},[r("label",{staticClass:"form-label"},[e._v("Start Date")]),r("DatePicker",{model:{value:e.annual_review.review_start,callback:function(t){e.$set(e.annual_review,"review_start",t)},expression:"annual_review.review_start"}}),r("Errors",{attrs:{errors:e.errors.review_start}})],1),r("div",{staticClass:"col-6"},[r("label",{staticClass:"form-label"},[e._v("End Date")]),r("DatePicker",{model:{value:e.annual_review.review_end,callback:function(t){e.$set(e.annual_review,"review_end",t)},expression:"annual_review.review_end"}}),r("Errors",{attrs:{errors:e.errors.review_end}})],1)]),r("template",{slot:"modal-footer"},[r("button",{staticClass:"btn btn-link",on:{click:e.hideModal}},[e._v("Cancel")]),r("button",{staticClass:"btn btn-dark",on:{click:e.submit}},[e._v("Create")])])],2)],1)},w=[],h=r("1315");function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(){return Math.random().toFixed(10).toString().replace(".","")},y=new Date,C=y.getFullYear(),x={props:{inline:{type:Boolean,default:!0},reviews:{type:Array,required:!1,default:[]}},data:function(){return{modalId:"modal_".concat(g()),annual_review:{name:"",year:C,review_start:"",review_end:""},reviewSelected:null,errors:{}}},methods:b(b({},Object(v["b"])({createReview:"annual/createReview",updateReview:"annual/updateReview",duplicateReview:"annual/duplicateReview"})),{},{hideModal:function(){this.errors={},this.$bvModal.hide(this.modalId)},validates:function(){var e=this,t=["name","review_start","review_end"];t.forEach((function(t){var r=[];e.annual_review[t]||r.push("Required field"),"review_end"===t&&e.annual_review.review_start&&e.annual_review.review_end&&e.annual_review.review_start>e.annual_review.review_end&&r.push("Date must occur after start date"),r.length>0?e.$set(e.errors,t,r):e.errors[t]&&delete e.errors[t]}))},submit:function(e){var t=this;return s()(d.a.mark((function r(){var a;return d.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.preventDefault(),t.validates(),!(Object.keys(t.errors).length>0)){r.next=4;break}return r.abrupt("return");case 4:if(!t.reviewSelected){r.next=7;break}return t.$store.dispatch("annual/duplicateReview",{id:t.reviewSelected}).then((function(e){var r=e,a={id:r.id,name:t.annual_review.name,year:C,review_start:t.annual_review.review_start,review_end:t.annual_review.review_end,regulatory_changes_attributes:r.regulatory_changes,material_business_changes:r.material_business_changes,annual_review_employees_attributes:r.annual_review_employees};t.$store.dispatch("annual/updateReview",a).then((function(e){t.toast("Success","Internal review has been created."),t.$emit("saved"),t.$bvModal.hide(t.modalId),t.$router.push({name:"annual-reviews-general",params:{annualId:e.id}})}))["catch"]((function(e){return console.error(e)}))}))["catch"]((function(e){return t.toast("Error","Internal review has not been created. Please try again. ".concat(e.message),!0)})),r.abrupt("return");case 7:return r.prev=7,r.next=10,t.createReview(t.annual_review);case 10:if(a=r.sent,!a.errors){r.next=15;break}return t.toast("Error","".concat(a.status),!0),Object.keys(a.errors).map((function(e){return a.errors[e].map((function(r){return t.toast("Error","".concat(e,": ").concat(r))}))})),r.abrupt("return");case 15:a.errors||(t.toast("Success","Internal review has been created."),t.$emit("saved"),t.$router.push({name:"annual-reviews-general",params:{annualId:a.id}})),r.next=21;break;case 18:r.prev=18,r.t0=r["catch"](7),t.toast("Error",r.t0.message,!0);case 21:case"end":return r.stop()}}),r,null,[[7,18]])})))()}}),computed:b(b({},Object(v["c"])({filefolders:"filefolders/filefolders",currentFileFolders:"filefolders/currentFileFolders",currentFolderId:"filefolders/currentFolder",currentFolderName:"filefolders/currentFolderName"})),{},{reviewsOptions:function(){var e=this.reviews.map((function(e){return{value:e.id,text:e.name}}));return e||[]}}),watch:{"annual_review.review_start":{handler:function(e,t){var r=h["DateTime"].fromSQL(e),a=h["DateTime"].fromSQL(this.annual_review.review_end);!r.invalid&&(a.invalid||a.startOf("day")<r.startOf("day"))&&(this.annual_review.review_end=e)}}}},O=x,k=r("2877"),R=Object(k["a"])(O,p,w,!1,null,null,null),j=R.exports,D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("table",{staticClass:"table reviews-table"},[r("thead",[r("tr",[r("th",{attrs:{width:"25%"}},[e._v("Name")]),r("th",{attrs:{width:"25%"},on:{click:function(t){return e.sortSelect("progress","number")}}},[e._v("Progress"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{staticClass:"text-right",on:{click:function(t){return e.sortSelect("findings","number")}}},[e._v("Findings"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{staticClass:"text-right",on:{click:function(t){return e.sortSelect("updated_at","date")}}},[e._v("Last Modified"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{staticClass:"text-right",on:{click:function(t){return e.sortSelect("created_at","date")}}},[e._v("Date Create"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{staticClass:"text-right",on:{click:function(t){return e.sortSelect("created_at","date")}}},[e._v("Date Completed"),r("b-icon",{staticClass:"ml-2",attrs:{icon:"chevron-expand"}})],1),r("th",{attrs:{width:"35px"}})])]),r("tbody",e._l(e.sortedReview,(function(e){return r("ReviewItem",{key:e.id,attrs:{item:e}})})),1)])},S=[],E=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("td",[r("router-link",{staticClass:"link",attrs:{to:"/business/annual_reviews/"+e.item.id}},[e._v(e._s(e.item.name))])],1),r("td",[r("div",{staticClass:"reviews-table__progress d-flex align-items-center"},[r("div",{staticClass:"reviews-table__progress-numbers mr-2",class:100===e.progressWidth?"text-success":"text-dark"},[e._v(e._s(e.item.progress)+"/"+e._s(e.item.review_categories.length))]),r("b-progress",{staticClass:"w-100",attrs:{value:e.progressWidth,max:100,"show-progress":"",variant:"success"}})],1)]),r("td",{staticClass:"text-right"},[e._v(e._s(e.item.findings))]),r("td",{staticClass:"text-right"},[e._v(e._s(e._f("asDate")(e.item.updated_at)))]),r("td",{staticClass:"text-right"},[e._v(e._s(e._f("asDate")(e.item.created_at)))]),r("td",{staticClass:"text-right"},[e._v(e._s(e._f("asDate")(e.item.review_end)))]),r("td",{staticClass:"text-right"},[r("div",{staticClass:"actions"},[r("b-dropdown",{staticClass:"m-0 p-0",attrs:{size:"sm",variant:"none",right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[r("b-icon",{attrs:{icon:"three-dots"}})]},proxy:!0}])},[r("router-link",{staticClass:"dropdown-item",attrs:{to:"/business/annual_reviews/"+e.item.id}},[e._v("Edit")]),r("b-dropdown-item",{on:{click:function(t){return e.duplicateReview(e.item.id)}}},[e._v("Duplicate")]),r("AnnualModalDelete",{attrs:{inline:!1},on:{deleteConfirmed:function(t){return e.deleteReview(e.item.id)}}},[r("b-dropdown-item",{staticClass:"delete"},[e._v("Delete")])],1),r("b-dropdown-item",{staticClass:"d-none"},[r("a",{staticClass:"link",attrs:{href:e.item.pdf_url,target:"_blank"}},[e._v("Download")])])],1)],1)])])},I=[],$=r("5a64"),P={name:"ReviewItem",props:["item"],components:{AnnualModalDelete:$["a"]},computed:{progressWidth:function(){var e=100/+this.item.review_categories.length;return+e*+this.item.progress}},methods:{duplicateReview:function(e){var t=this;this.$store.dispatch("annual/duplicateReview",{id:e}).then((function(e){return t.toast("Success","The annual review has been duplicated! ".concat(e.id))}))["catch"]((function(e){return t.toast("Error","Something wrong! ".concat(e.message),!0)}))},deleteReview:function(e){var t=this;this.$store.dispatch("annual/deleteReview",{id:e}).then((function(e){return t.toast("Success","The annual review has been deleted! ".concat(e.id))}))["catch"]((function(e){return t.toast("Error","Something wrong! ".concat(e.message),!0)}))}}},M=P,T=Object(k["a"])(M,E,I,!1,null,"01363dc5",null),F=T.exports,N={components:{ReviewItem:F},props:{reviews:{type:Array,required:!0}},data:function(){return{sortOptions:{field:"progress",type:"number",reverse:!1}}},computed:{sortedReview:function(){var e=this.sortOptions;return this.reviews.sort((function(t,r){if("number"===e.type)return e.reverse?r[e.field]-t[e.field]:t[e.field]-r[e.field];if("date"===e.type){var a=new Date(t[e.field]),n=new Date(r[e.field]);return e.reverse?n-a:a-n}if("string"===e.type){var i=t[e.field].toLowerCase(),s=r[e.field].toLowerCase();return e.reverse?i>s?-1:i<s?1:0:i<s?-1:i>s?1:0}}))}},methods:{sortSelect:function(e,t){var r=this.sortOptions;e!==r.field?this.sortOptions={field:e,type:t,reverse:!1}:this.sortOptions.reverse=!r.reverse}}},A=N,L=Object(k["a"])(A,D,S,!1,null,null,null),q=L.exports;function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var J={components:{Notifications:u["a"],Loading:f["a"],EmptyState:m["a"],ReviewTable:q,AnnualModalCreate:j},data:function(){return{notify:{show:"show",mainText:"Key Regulatory Developments 2021",subText:"New regulatory changes can have an impact on your policies and procedures.",variant:"primary",dismissible:!1,icon:null,scale:2,animation:""}}},methods:{},computed:B(B({loading:function(){return this.$store.getters.loading}},Object(v["c"])({reviews:"annual/reviews"})),{},{recentCompletedReview:function(){var e=this.reviews.filter((function(e){return e.completed_at&&e.complete})),t=e.sort((function(e,t){return e.completed_at>t.completed_at?-1:e.completed_at<t.completed_at?1:0}));return t.length>0?t[0]:null},noticeText:function(){var e="Rule 206(4)-7 under the Adviser Act requires that you conduct a review of your compliance program no less than annually.";if(this.recentCompletedReview){var t=h["DateTime"].fromISO(this.recentCompletedReview.completed_at).toFormat("MM/dd/yyyy");return"".concat(e,' Your last completed internal review was on&nbsp; <a class="link" href="/business/annual_reviews/').concat(this.recentCompletedReview.id,'"> ').concat(t,"</a>")}return e}}),mounted:function(){var e=this;return s()(d.a.mark((function t(){return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("annual/getReviews");case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),e.toast("Error",t.t0.message,!0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()}},Q=J,Y=(r("57d3"),r("2a31"),Object(k["a"])(Q,a,n,!1,null,"469ad412",null));t["default"]=Y.exports},8622:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.notify?r("b-alert",{staticClass:"notifications",attrs:{show:e.notify.show,variant:e.notify.variant?e.notify.variant:"primary",dismissible:e.notify.dismissible}},[r("div",{staticClass:"d-flex align-items-center"},[e.notifyIcon?r("b-icon",{staticClass:"m-r-2 m-l-1",attrs:{icon:e.notifyIcon,animation:e.notify.animation,scale:e.notify.scale,variant:e.notify.variant}}):e._e(),r("div",{staticClass:"d-block mr-auto"},[e.notify.mainText?r("h4",{staticClass:"notifications__title"},[r("b",[e._v(e._s(e.notify.mainText))])]):e._e(),e.notify.subText?r("p",{staticClass:"notifications__sub-title mb-0"},[e._v(e._s(e.notify.subText))]):e._e()]),r("span",{on:{click:function(t){return e.$emit("click")}}},[e._t("default")],2)],1)]):e._e()},n=[],i={props:{notify:{type:Object,required:!0}},components:{},data:function(){return{}},computed:{notifyIcon:function(){if(this.notify.icon)return this.notify.icon;var e=this.notify.variant;return"primary"!==e&&"info"!==e||(this.notify.icon=""),"success"===e&&(this.notify.icon="check-circle-fill"),"warning"===e&&(this.notify.icon="exclamation-triangle-fill"),"danger"===e&&(this.notify.icon="dash-circle-fill"),this.notify.icon}}},s=i,o=r("2877"),l=Object(o["a"])(s,a,n,!1,null,"9ff56fd0",null);t["a"]=l.exports},"8a45":function(e,t,r){},d1db:function(e,t,r){e.exports=r.p+"img/error_20.5080af0b.svg"}}]);
//# sourceMappingURL=chunk-d46c4a9e.510ff5c9.js.map